@startuml
title Ablauf des Benchmark-Frameworks (vereinfacht)

actor User
participant Runner as "BenchmarkRunner"
participant Generator as "Generator"
participant Logger as "heiDPI_logger"
participant Watcher as "Watcher"
participant Analyzer as "Analyzer"
participant Switcher as "Scenario-Switcher"

== Start ==
User -> Runner: Programmstart
Runner -> Runner: config.json & scenarios.json laden
Runner -> Generator: start
Generator -> Runner: ready
Runner -> Logger: logger starten
Runner -> Watcher: start
Runner -> Analyzer: start
Runner -> Switcher: start
Runner -> Runner: waitForStop()

== Parallelbetrieb ==
par Generator
  loop running
    Generator -> Logger: send(flow_event_json)
  end
else Watcher
  loop running
    Watcher -> Analyzer: enqueue(sample)
  end
else Analyzer
  loop running
    Analyzer -> Analyzer: latency berechnen
  end
else Switcher
  loop running
    Switcher -> Generator: Szenario aktualisieren
  end
end

== Abbruch ==
User -> Runner: SIGINT / SIGTERM
Runner -> Generator: join()
Runner -> Watcher: join()
Runner -> Analyzer: join()
Runner -> Switcher: join()
Runner -> Logger: kill(SIGTERM)
Runner --> User: Benchmark terminated.
@enduml

